<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Geotopia Pt6 The Mayor</title>
  <link href="https://fonts.googleapis.com/css2?family=Caveat:wght@700&display=swap" rel="stylesheet">
  <style>
    /* Main Code Styles */
    /* Basic layout */
    body, html {
      margin: 0;
      padding: 0;
      height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
    }
    #app-container {
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    /* Header */
    #header {
      width: 960px;
      background: #eee;
      padding: 10px;
      margin-bottom: 10px;
    }
    #header-top {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 10px;
    }
    #translation-widget span {
      vertical-align: middle;
    }
    #translation-widget a {
      text-decoration: none;
    }
    /* Container & pages */
    #container {
      position: relative;
      width: 960px;
      height: 540px;
      border: 1px solid #ccc;
    }
    .page {
      position: absolute;
      top: 0;
      left: 0;
      width: 960px;
      height: 540px;
      display: none;
    }
    .page.active {
      display: block;
    }
    /* Background image via an <img> element */
    .page .bg {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      object-fit: contain;
      z-index: -1;
    }
    /* Boxes and inputs */
    .box, input.answer {
      position: absolute;
      text-align: center;
      font-weight: bold;
      font-size: 18px;
      line-height: normal;
      border: 1px solid black;
    }
    input.answer {
      /* No placeholder text */
    }
    /* Navigation buttons area */
    #nav-buttons {
      margin-top: 10px;
    }
    button {
      font-family: "Caveat", cursive;
      font-size: 20px;
      background-color: lightblue;
      border: none;
      padding: 10px 20px;
      margin: 0 5px;
      cursor: pointer;
    }
    /* Progress bar */
    #progressBar {
      width: 100%;
      background: #ccc;
      height: 20px;
    }
    #progress {
      width: 0%;
      background: green;
      height: 100%;
    }
  </style>
  <!-- Side Widget Styles -->
  <style>
    /* Side widget styling */
    #side-widget {
      position: fixed;
      top: 20px;
      right: 20px; /* Change to left:20px; if you prefer */
      width: 200px;
      height: 200px;
      background: #f9f9f9;
      border: 1px solid #ccc;
      padding: 10px;
      box-sizing: border-box;
      font-family: 'Caveat', cursive;
      z-index: 999;
    }
    #side-widget p.title {
      font-size: 24px;
      text-align: center;
      margin: 0 0 10px;
    }
    #side-widget button,
    #side-widget a {
      display: block;
      margin: 0 auto;
      font-size: 20px;
      cursor: pointer;
      text-align: center;
      background: lightblue;
      border: none;
      padding: 10px;
      text-decoration: none;
      color: inherit;
    }
    /* Selection overlay styles */
    #selection-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      cursor: crosshair;
      z-index: 1000;
    }
    #selection-box {
      position: absolute;
      border: 2px dashed red;
      background: rgba(0,0,0,0.1);
    }
  </style>
  <!-- html2canvas library -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
</head>
<body>
  <div id="app-container">
    <!-- Header -->
    <div id="header">
      <div id="header-top">
        <div>
          <input type="text" id="username" placeholder="Enter your name" style="font-size:16px; padding:5px;">
          <button id="confirmBtn" onclick="confirmName()">Confirm</button>
        </div>
      </div>
      <div id="progressBar">
        <div id="progress"></div>
      </div>
      <span id="progressText">0% completed</span>
    </div>
    <!-- Container -->
    <div id="container">
      <!-- MAIN PAGES (IDs: 1,2,3, and 12 to 23) -->
      <!-- Page 1 -->
      <div id="page1" class="page active">
        <img class="bg" src="https://daryeaye.github.io/gt6/6-01.jpg" alt="Page 1 Background">
        <a href="https://daryeaye.github.io/geotopia/GT1%20Officer+.pdf" target="_blank">
          <div class="box" style="left:12px; top:385px; width:120px; height:105px; border:1px solid red;"></div>
        </a>
        <a href="https://daryeaye.github.io/geotopia/GT1%20Professor+.pdf" target="_blank">
          <div class="box" style="left:151px; top:385px; width:120px; height:105px; border:1px solid red;"></div>
        </a>
        <a href="https://daryeaye.github.io/geotopia/GT1%20Hacker+.pdf" target="_blank">
          <div class="box" style="left:290px; top:385px; width:120px; height:105px; border:1px solid red;"></div>
        </a>
        <a href="https://www.youtube.com/watch?v=Fj98o3aFfk8" target="_blank" style="position:absolute; left:134px; top:490px; width:177px; height:32px; background-color: rgba(128,128,128,0.9); font-family: 'Caveat', cursive; font-size: 22px; display: flex; align-items: center; justify-content: center; text-decoration: none; color: white;">How to use the file?</a>
      </div>
      <!-- Page 2 -->
      <div id="page2" class="page">
        <img class="bg" src="https://daryeaye.github.io/gt6/6-02.jpg" alt="Page 2 Background">
      </div>
      <!-- Page 3 (Hub) -->
      <div id="page3" class="page">
        <img class="bg" src="https://daryeaye.github.io/gt6/6-03.jpg" alt="Page 3 Background">
        <!-- Hub boxes with updated color grouping and IDs: -->
        <div id="boxC" class="box" style="left:733px; top:151px; width:57px; height:64px; background: rgba(0,0,255,0.5);" onclick="showSubPage(4)">C</div>
        <div id="boxE" class="box" style="left:338px; top:169px; width:60px; height:64px; background: rgba(0,0,255,0.5);" onclick="showSubPage(5)">E</div>
        <div id="boxA" class="box" style="left:479px; top:90px; width:56px; height:64px; background: rgba(0,0,255,0.5);" onclick="showSubPage(8)">A</div>
        <div id="boxD" class="box" style="left:165px; top:161px; width:42px; height:64px; background: rgba(0,0,255,0.5);" onclick="showSubPage(9)">D</div>
        <div id="boxH" class="box" style="left:479px; top:395px; width:74px; height:64px; background: rgba(255,0,0,0.5);" onclick="showSubPage(6)">H</div>
        <div id="boxG" class="box" style="left:695px; top:345px; width:57px; height:64px; background: rgba(255,0,0,0.5);" onclick="showSubPage(7)">G</div>
        <div id="boxF" class="box" style="left:386px; top:345px; width:42px; height:64px; background: rgba(255,0,0,0.5);" onclick="showSubPage(10)">F</div>
        <div id="boxB" class="box" style="left:570px; top:135px; width:42px; height:64px; background: rgba(255,0,0,0.5);" onclick="showSubPage(11)">B</div>
      </div>
      <!-- Page 12 (no middle text) -->
      <div id="page12" class="page">
        <img class="bg" src="https://daryeaye.github.io/gt6/6-12.jpg" alt="Page 12 Background">
      </div>
      <!-- Pages 13 to 22 (Main pages with interactive boxes) -->
      <div id="page13" class="page">
        <img class="bg" src="https://daryeaye.github.io/gt6/6-13.jpg" alt="Page 13 Background">
        <input type="text" id="box1_page13" class="answer" style="left:866px; top:176px; width:72px; height:41px; background: lightblue;">
        <input type="text" id="box2_page13" class="answer" style="left:760px; top:283px; width:72px; height:40px; background: lightblue;">
        <img src="https://daryeaye.github.io/gt6/Cross3.gif" alt="Cross3" style="position:absolute; left:33px; top:301px; width:359px; height:205px; border:1px solid black;">
        <input type="text" id="answer720_page13" class="answer" style="left:433px; top:418px; width:500px; height:95px; background: lightblue;">
      </div>
      <div id="page14" class="page">
        <img class="bg" src="https://daryeaye.github.io/gt6/6-14.jpg" alt="Page 14 Background">
        <input type="text" id="box1_page14" class="answer" style="left:866px; top:176px; width:72px; height:41px; background: lightblue;">
        <input type="text" id="box2_page14" class="answer" style="left:725px; top:252px; width:72px; height:41px; background: lightblue;">
        <img src="https://daryeaye.github.io/gt6/Cross4.gif" alt="Cross4" style="position:absolute; left:19px; top:294px; width:383px; height:218px; border:1px solid black;">
        <input type="text" id="answer468_page14" class="answer" style="left:433px; top:418px; width:500px; height:95px; background: lightblue;">
      </div>
      <div id="page15" class="page">
        <img class="bg" src="https://daryeaye.github.io/gt6/6-15.jpg" alt="Page 15 Background">
        <input type="text" id="box1_page15" class="answer" style="left:792px; top:181px; width:72px; height:41px; background: lightblue;">
        <img src="https://daryeaye.github.io/gt6/Cross2.gif" alt="Cross2" style="position:absolute; left:82px; top:282px; width:250px; height:197px; border:1px solid black;">
        <input type="text" id="box3_page15" class="answer" style="left:748px; top:283px; width:72px; height:40px; background: lightblue;">
        <input type="text" id="answer50_page15" class="answer" style="left:433px; top:418px; width:500px; height:95px; background: lightblue;">
      </div>
      <div id="page16" class="page">
        <img class="bg" src="https://daryeaye.github.io/gt6/6-16.jpg" alt="Page 16 Background">
        <input type="text" id="box1_page16" class="answer" style="left:755px; top:168px; width:72px; height:40px; background: lightblue;">
        <input type="text" id="box2_page16" class="answer" style="left:709px; top:280px; width:72px; height:41px; background: lightblue;">
        <img src="https://daryeaye.github.io/gt6/Cross1.gif" alt="Cross1" style="position:absolute; left:87px; top:292px; width:240px; height:196px; border:1px solid black;">
        <input type="text" id="answer60_page16" class="answer" style="left:433px; top:418px; width:500px; height:95px; background: lightblue;">
      </div>
      <div id="page17" class="page">
        <img class="bg" src="https://daryeaye.github.io/gt6/6-17.jpg" alt="Page 17 Background">
        <img src="https://daryeaye.github.io/gt6/Cross3.gif" alt="Cross3" style="position:absolute; left:56px; top:23px; width:360px; height:205px; border:1px solid black;">
        <input type="text" id="answer400_page17" class="answer" style="left:50px; top:369px; width:365px; height:96px; background: lightblue;">
      </div>
      <div id="page18" class="page">
        <img class="bg" src="https://daryeaye.github.io/gt6/6-18.jpg" alt="Page 18 Background">
        <img src="https://daryeaye.github.io/gt6/Cross2.gif" alt="Cross2" style="position:absolute; left:111px; top:28px; width:250px; height:197px; border:1px solid black;">
        <input type="text" id="answer100_page18" class="answer" style="left:50px; top:369px; width:365px; height:96px; background: lightblue;">
      </div>
      <!-- Pages 19, 20, 21: Remove any middle text -->
      <div id="page19" class="page">
        <img class="bg" src="https://daryeaye.github.io/gt6/6-19.jpg" alt="Page 19 Background">
      </div>
      <div id="page20" class="page">
        <img class="bg" src="https://daryeaye.github.io/gt6/6-20.jpg" alt="Page 20 Background">
      </div>
      <div id="page21" class="page">
        <img class="bg" src="https://daryeaye.github.io/gt6/6-21.jpg" alt="Page 21 Background">
      </div>
      <!-- Page 22 with unlock button -->
      <div id="page22" class="page">
        <img class="bg" src="https://daryeaye.github.io/gt6/6-22.jpg" alt="Page 22 Background">
        <input type="text" id="answer5348_page22" class="answer" style="left:353px; top:464px; width:254px; height:52px; background: #ffffffff;">
        <button id="unlock_btn" style="position:absolute; left:421px; top:413px; width:118px; height:52px; border: 1px solid black;" onclick="checkPasswordPage22()">Unlock</button>
      </div>
      <div id="page23" class="page" style="position: relative;">
        <img src="https://daryeaye.github.io/gt6/6-23.jpg" alt="Page 23 Image" style="width: 100%; display: block;">
        <a href="https://daryeaye.github.io/gt6/chaermosi.html" target="_blank" style="
          position: absolute;
          left: 310px;
          top: 435px;
          width: 370px;
          height: 45px;
          background-color: rgba(255, 0, 0, 0.7);
          display: block;
          text-decoration: none;
          pointer-events: auto;
        "></a>
      </div>
      
      <!-- SUBORDINATE PAGES -->
      <!-- Page 4_sub -->
      <div id="page4_sub" class="page">
        <img class="bg" src="https://daryeaye.github.io/gt6/6-04.jpg" alt="Page 4 Background">
        <img src="https://daryeaye.github.io/gt6/TP.gif" alt="TP.gif" style="position:absolute; left:499px; top:23px; width:304px; height:155px; border:1px solid black;">
        <a href="https://www.geogebra.org/m/e5gz5gfc" target="_blank" style="position:absolute; left:433px; top:181px; width:499px; height:56px; display:block; border:1px solid black; background: transparent; text-decoration:none;"></a>
        <input type="text" id="box1_page4" class="answer" style="left:603px; top:284px; width:89px; height:47px; background: lightblue;">
        <input type="text" id="answer80_page4" class="answer" style="left:721px; top:284px; width:104px; height:47px; background: lightblue;">
        <input type="text" id="box3_page4" class="answer" style="left:312px; top:287px; width:257px; height:47px; background: lightblue;">
        <input type="text" id="box4_page4" class="answer" style="left:141px; top:315px; width:63px; height:42px; background: lightblue;">
        <input type="text" id="box5_page4" class="answer" style="left:118px; top:359px; width:63px; height:41px; background: lightblue;">
        <input type="text" id="box6_page4" class="answer" style="left:135px; top:402px; width:63px; height:42px; background: lightblue;">
        <input type="text" id="box7_page4" class="answer" style="left:306px; top:426px; width:63px; height:47px; background: lightblue;">
        <input type="text" id="box8_page4" class="answer" style="left:403px; top:426px; width:63px; height:47px; background: lightblue;">
        <input type="text" id="box9_page4" class="answer" style="left:500px; top:426px; width:63px; height:47px; background: lightblue;">
        <input type="text" id="box10_page4" class="answer" style="left:597px; top:426px; width:63px; height:47px; background: lightblue;">
        <input type="text" id="box11_page4" class="answer" style="left:694px; top:426px; width:63px; height:47px; background: lightblue;">
        <input type="text" id="answer138_page4" class="answer" style="left:786px; top:426px; width:89px; height:47px; background: lightblue;">
        <input type="text" id="box13_page4" class="answer" style="left:165px; top:446px; width:63px; height:43px; background: lightblue;">
      </div>
      
      <!-- Page 5_sub -->
      <div id="page5_sub" class="page">
        <img class="bg" src="https://daryeaye.github.io/gt6/6-05.jpg" alt="Page 5 Background">
        <img src="https://daryeaye.github.io/gt6/TP.gif" alt="TP.gif" style="position:absolute; left:499px; top:23px; width:304px; height:155px; border:1px solid black;">
        <a href="https://www.geogebra.org/m/e5gz5gfc" target="_blank" style="position:absolute; left:433px; top:181px; width:499px; height:56px; display:block; border:1px solid black; background: transparent; text-decoration:none;"></a>
        <input type="text" id="box1_page5" class="answer" style="left:603px; top:284px; width:89px; height:47px; background: lightblue;">
        <input type="text" id="answer84_page5" class="answer" style="left:721px; top:284px; width:104px; height:47px; background: lightblue;">
        <input type="text" id="box3_page5" class="answer" style="left:312px; top:287px; width:257px; height:47px; background: lightblue;">
        <input type="text" id="box4_page5" class="answer" style="left:141px; top:315px; width:63px; height:42px; background: lightblue;">
        <input type="text" id="box5_page5" class="answer" style="left:118px; top:359px; width:63px; height:41px; background: lightblue;">
        <input type="text" id="box6_page5" class="answer" style="left:135px; top:402px; width:63px; height:42px; background: lightblue;">
        <input type="text" id="box7_page5" class="answer" style="left:306px; top:426px; width:63px; height:47px; background: lightblue;">
        <input type="text" id="box8_page5" class="answer" style="left:403px; top:426px; width:63px; height:47px; background: lightblue;">
        <input type="text" id="box9_page5" class="answer" style="left:500px; top:426px; width:63px; height:47px; background: lightblue;">
        <input type="text" id="box10_page5" class="answer" style="left:597px; top:426px; width:63px; height:47px; background: lightblue;">
        <input type="text" id="box11_page5" class="answer" style="left:694px; top:426px; width:63px; height:47px; background: lightblue;">
        <input type="text" id="answer136_page5" class="answer" style="left:786px; top:426px; width:89px; height:47px; background: lightblue;">
        <input type="text" id="box13_page5" class="answer" style="left:165px; top:446px; width:63px; height:43px; background: lightblue;">
      </div>
      
      <!-- Page 6_sub -->
      <div id="page6_sub" class="page">
        <img class="bg" src="https://daryeaye.github.io/gt6/6-06.jpg" alt="Page 6 Background">
        <img src="https://daryeaye.github.io/gt6/TP.gif" alt="TP.gif" style="position:absolute; left:499px; top:23px; width:304px; height:155px; border:1px solid black;">
        <a href="https://www.geogebra.org/m/bxcrmmm6" target="_blank" style="position:absolute; left:433px; top:181px; width:499px; height:56px; display:block; border:1px solid black; background: transparent; text-decoration:none;"></a>
        <input type="text" id="answer360" class="answer" style="left:310px; top:287px; width:615px; height:87px; background: lightblue;">
        <input type="text" id="answerTri_page6" class="answer" style="left:35px; top:392px; width:218px; height:98px; background: lightblue;">
        <input type="text" id="answer336" class="answer" style="left:310px; top:424px; width:615px; height:86px; background: lightblue;">
      </div>
      
      <!-- Page 7_sub -->
      <div id="page7_sub" class="page">
        <img class="bg" src="https://daryeaye.github.io/gt6/6-07.jpg" alt="Page 7 Background">
        <img src="https://daryeaye.github.io/gt6/TP.gif" alt="TP.gif" style="position:absolute; left:499px; top:23px; width:304px; height:155px; border:1px solid black;">
        <a href="https://www.geogebra.org/m/bxcrmmm6" target="_blank" style="position:absolute; left:433px; top:181px; width:499px; height:56px; display:block; border:1px solid black; background: transparent; text-decoration:none;"></a>
        <input type="text" id="answer120" class="answer" style="left:310px; top:287px; width:615px; height:87px; background: lightblue;">
        <input type="text" id="answerTri_page7" class="answer" style="left:35px; top:392px; width:218px; height:98px; background: lightblue;">
        <input type="text" id="answer284" class="answer" style="left:310px; top:424px; width:615px; height:86px; background: lightblue;">
      </div>
      
      <!-- Page 8_sub -->
      <div id="page8_sub" class="page">
        <img class="bg" src="https://daryeaye.github.io/gt6/6-08.jpg" alt="Page 8 Background">
        <img src="https://daryeaye.github.io/gt6/SPP.gif" alt="SPP.gif" style="position:absolute; left:516px; top:7px; width:259px; height:171px; border:1px solid black;">
        <a href="https://www.geogebra.org/m/e5gz5gfc" target="_blank" style="position:absolute; left:433px; top:181px; width:499px; height:56px; display:block; border:1px solid black; background: transparent; text-decoration:none;"></a>
        <input type="text" id="box1_page8" class="answer" style="left:400px; top:284px; width:177px; height:47px; background: lightblue;">
        <input type="text" id="box2_page8" class="answer" style="left:610px; top:284px; width:87px; height:47px; background: lightblue;">
        <input type="text" id="answer64_page8" class="answer" style="left:730px; top:284px; width:110px; height:47px; background: lightblue;">
        <input type="text" id="answer144_page8" class="answer" style="left:749px; top:426px; width:99px; height:47px; background: lightblue;">
        <input type="text" id="box4_page8" class="answer" style="left:141px; top:315px; width:63px; height:42px; background: lightblue;">
        <input type="text" id="box5_page8" class="answer" style="left:118px; top:359px; width:63px; height:41px; background: lightblue;">
        <input type="text" id="box6_page8" class="answer" style="left:135px; top:402px; width:63px; height:42px; background: lightblue;">
        <input type="text" id="box7_page8" class="answer" style="left:305px; top:426px; width:68px; height:47px; background: lightblue;">
        <input type="text" id="box8_page8" class="answer" style="left:392px; top:426px; width:68px; height:47px; background: lightblue;">
        <input type="text" id="box9_page8" class="answer" style="left:484px; top:426px; width:68px; height:47px; background: lightblue;">
        <input type="text" id="box10_page8" class="answer" style="left:568px; top:426px; width:68px; height:47px; background: lightblue;">
        <input type="text" id="box11_page8" class="answer" style="left:659px; top:426px; width:68px; height:47px; background: lightblue;">
        <input type="text" id="box13_page8" class="answer" style="left:165px; top:446px; width:63px; height:43px; background: lightblue;">
      </div>
      
      <div id="page9_sub" class="page">
        <img class="bg" src="https://daryeaye.github.io/gt6/6-09.jpg" alt="Page 9 Background">
        <img src="https://daryeaye.github.io/gt6/SPP.gif" alt="SPP.gif" style="position:absolute; left:516px; top:7px; width:259px; height:171px; border:1px solid black;">
        <a href="https://www.geogebra.org/m/e5gz5gfc" target="_blank" style="position:absolute; left:433px; top:181px; width:499px; height:56px; display:block; border:1px solid black; background: transparent; text-decoration:none;"></a>
        <input type="text" id="box1_page9" class="answer" style="left:400px; top:284px; width:177px; height:47px; background: lightblue;">
        <input type="text" id="box2_page9" class="answer" style="left:610px; top:284px; width:87px; height:47px; background: lightblue;">
        <input type="text" id="answer50_page9" class="answer" style="left:730px; top:284px; width:110px; height:47px; background: lightblue;">
        <input type="text" id="box4_page9" class="answer" style="left:141px; top:315px; width:63px; height:42px; background: lightblue;">
        <input type="text" id="box5_page9" class="answer" style="left:118px; top:359px; width:63px; height:41px; background: lightblue;">
        <input type="text" id="box6_page9" class="answer" style="left:135px; top:402px; width:63px; height:42px; background: lightblue;">
        <input type="text" id="box7_page9" class="answer" style="left:305px; top:426px; width:68px; height:47px; background: lightblue;">
        <input type="text" id="box8_page9" class="answer" style="left:392px; top:426px; width:68px; height:47px; background: lightblue;">
        <input type="text" id="box9_page9" class="answer" style="left:484px; top:426px; width:68px; height:47px; background: lightblue;">
        <input type="text" id="box10_page9" class="answer" style="left:568px; top:426px; width:68px; height:47px; background: lightblue;">
        <input type="text" id="box11_page9" class="answer" style="left:659px; top:426px; width:68px; height:47px; background: lightblue;">
        <input type="text" id="answer90_page9" class="answer" style="left:749px; top:426px; width:99px; height:47px; background: lightblue;">
        <input type="text" id="box13_page9" class="answer" style="left:165px; top:446px; width:63px; height:43px; background: lightblue;">
      </div>
      
      <!-- Page 10_sub -->
      <div id="page10_sub" class="page">
        <img class="bg" src="https://daryeaye.github.io/gt6/6-10.jpg" alt="Page 10 Background">
        <img src="https://daryeaye.github.io/gt6/SPP.gif" alt="SPP.gif" style="position:absolute; left:499px; top:23px; width:304px; height:155px; border:1px solid black;">
        <a href="https://www.geogebra.org/m/bxcrmmm6" target="_blank" style="position:absolute; left:433px; top:181px; width:499px; height:56px; display:block; border:1px solid black; background: transparent; text-decoration:none;"></a>
        <input type="text" id="answer114_page10" class="answer" style="left:310px; top:287px; width:615px; height:87px; background: lightblue;">
        <input type="text" id="answerSqu_page10" class="answer" style="left:35px; top:392px; width:218px; height:98px; background: lightblue;">
        <input type="text" id="answer156_page10" class="answer" style="left:310px; top:424px; width:615px; height:86px; background: lightblue;">
      </div>
      
      <!-- Page 11_sub -->
      <div id="page11_sub" class="page">
        <img class="bg" src="https://daryeaye.github.io/gt6/6-11.jpg" alt="Page 11 Background">
        <img src="https://daryeaye.github.io/gt6/SPP.gif" alt="SPP.gif" style="position:absolute; left:499px; top:23px; width:304px; height:155px; border:1px solid black;">
        <a href="https://www.geogebra.org/m/bxcrmmm6" target="_blank" style="position:absolute; left:433px; top:181px; width:499px; height:56px; display:block; border:1px solid black; background: transparent; text-decoration:none;"></a>
        <input type="text" id="box1_page11" class="answer" style="left:310px; top:287px; width:615px; height:87px; background: lightblue;">
        <input type="text" id="answerSqu_page11" class="answer" style="left:35px; top:392px; width:218px; height:98px; background: lightblue;">
        <input type="text" id="answer108_page11" class="answer" style="left:310px; top:424px; width:615px; height:86px; background: lightblue;">
      </div>
    </div>
    <!-- Navigation Buttons -->
    <div id="nav-buttons">
      <button id="prev-btn" onclick="prevPage()">Previous</button>
      <button id="next-btn" onclick="nextPage()">Next</button>
    </div>
  </div>
  <script>
    // Setup persistence for input.answer elements
    function setupPersistence() {
      document.querySelectorAll("input.answer").forEach(function(el) {
        let stored = localStorage.getItem(el.id);
        if(stored !== null) {
          el.value = stored;
        }
        el.addEventListener("input", function() {
          localStorage.setItem(el.id, el.value);
        });
      });
    }
    
    // Global progress tracking for 23 main pages
    let visitedPages = [];
    function markVisited(pageNum) {
      if(!visitedPages.includes(pageNum)) {
        visitedPages.push(pageNum);
      }
      updateProgress();
    }
    function updateProgress() {
      const progressPercent = (visitedPages.length / 23) * 100;
      document.getElementById('progress').style.width = progressPercent + '%';
      document.getElementById('progressText').innerText = progressPercent.toFixed(0) + '% completed';
    }
    
    // Global subordinate pages completion status
    let subPageStatus = {4: false, 5: false, 6: false, 7: false, 8: false, 9: false, 10: false, 11: false};
    
    // Main pages array (IDs 1,2,3 and 12..23)
    let currentPage = 1;
    const mainPages = [1, 2, 3, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23];
    
    function showPage(pageNum) {
      // Hide all main pages and subordinate pages
      mainPages.forEach(n => {
        let el = document.getElementById('page' + n);
        if(el) el.classList.remove('active');
      });
      document.querySelectorAll("[id$='_sub']").forEach(el => el.classList.remove('active'));
      document.getElementById('page' + pageNum).classList.add('active');
      // Restore nav buttons for main pages
      document.getElementById("nav-buttons").innerHTML = "<button id='prev-btn' onclick='prevPage()'>Previous</button><button id='next-btn' onclick='nextPage()'>Next</button>";
      currentPage = pageNum;
      markVisited(pageNum);
    }
    
    function showSubPage(pageNum) {
      // Hide main pages and subordinate pages
      mainPages.forEach(n => {
        let el = document.getElementById('page' + n);
        if(el) el.classList.remove('active');
      });
      document.querySelectorAll("[id$='_sub']").forEach(el => el.classList.remove('active'));
      document.getElementById('page' + pageNum + "_sub").classList.add('active');
      currentPage = pageNum;
      markVisited(pageNum);
      // Replace nav-buttons with a Back button
      document.getElementById("nav-buttons").innerHTML = "<button id='back-btn' onclick='backFromSubPage()'>Back</button>";
    }
    
    function backFromSubPage() {
      switch(currentPage) {
        case 4: checkAnswersAndGoBackPage4(); break;
        case 5: checkAnswersAndGoBackPage5(); break;
        case 6: checkAnswersAndGoBackPage6(); break;
        case 7: checkAnswersAndGoBackPage7(); break;
        case 8: checkAnswersAndGoBackPage8(); break;
        case 9: checkAnswersAndGoBackPage9(); break;
        case 10: checkAnswersAndGoBackPage10(); break;
        case 11: checkAnswersAndGoBackPage11(); break;
      }
    }
    
    function nextPage() {
      const idx = mainPages.indexOf(currentPage);
      if(currentPage === 3) {
        for(let key in subPageStatus) {
          if(!subPageStatus[key]) {
            alert("🤨 The Mayor needs you to be more professional. Check your answer!");
            return;
          }
        }
      }
      const validations = {
        13: () => document.getElementById('answer720_page13').value.toLowerCase().includes("720"),
        14: () => document.getElementById('answer468_page14').value.toLowerCase().includes("468"),
        15: () => document.getElementById('answer50_page15').value.toLowerCase().includes("50"),
        16: () => document.getElementById('answer60_page16').value.toLowerCase().includes("60"),
        17: () => document.getElementById('answer400_page17').value.toLowerCase().includes("400"),
        18: () => document.getElementById('answer100_page18').value.toLowerCase().includes("100"),
        22: () => true
      };
      if(validations[currentPage] && !validations[currentPage]()) {
        alert("🤨 The Mayor needs you to be more professional. Check your answer!");
        return;
      }
      if(idx < mainPages.length - 1) {
        showPage(mainPages[idx + 1]);
      }
    }
    
    function prevPage() {
      const idx = mainPages.indexOf(currentPage);
      if(idx > 0) {
        showPage(mainPages[idx - 1]);
      }
    }
    
    function checkAnswersAndGoBackPage4() {
      const ans80 = document.getElementById('answer80_page4').value.toLowerCase();
      const ans138 = document.getElementById('answer138_page4').value.toLowerCase();
      if(!ans80.includes("80") || !ans138.includes("138")) {
        alert("🤨 The Mayor needs you to be more professional. Check your answer!");
      } else {
        subPageStatus[4] = true;
        document.getElementById("boxC").innerHTML = "✅";
        showPage(3);
      }
    }
    function checkAnswersAndGoBackPage5() {
      const ans84 = document.getElementById('answer84_page5').value.toLowerCase();
      const ans136 = document.getElementById('answer136_page5').value.toLowerCase();
      if(!ans84.includes("84") || !ans136.includes("136")) {
        alert("🤨 The Mayor needs you to be more professional. Check your answer!");
      } else {
        subPageStatus[5] = true;
        document.getElementById("boxE").innerHTML = "✅";
        showPage(3);
      }
    }
    function checkAnswersAndGoBackPage6() {
      const ans360 = document.getElementById('answer360').value.toLowerCase();
      const ansTri = document.getElementById('answerTri_page6').value.toLowerCase();
      const ans336 = document.getElementById('answer336').value.toLowerCase();
      if(!ans360.includes("360") || !ansTri.includes("tri") || !ans336.includes("336")) {
        alert("🤨 The Mayor needs you to be more professional. Check your answer!");
      } else {
        subPageStatus[6] = true;
        document.getElementById("boxH").innerHTML = "✅";
        showPage(3);
      }
    }
    function checkAnswersAndGoBackPage7() {
      const ans120 = document.getElementById('answer120').value.toLowerCase();
      const ansTri = document.getElementById('answerTri_page7').value.toLowerCase();
      const ans284 = document.getElementById('answer284').value.toLowerCase();
      if(!ans120.includes("120") || !ansTri.includes("tri") || !ans284.includes("284")) {
        alert("🤨 The Mayor needs you to be more professional. Check your answer!");
      } else {
        subPageStatus[7] = true;
        document.getElementById("boxG").innerHTML = "✅";
        showPage(3);
      }
    }
    function checkAnswersAndGoBackPage8() {
      const ans64 = document.getElementById('answer64_page8').value.toLowerCase();
      const ans144 = document.getElementById('answer144_page8').value.toLowerCase();
      if(!ans64.includes("64") || !ans144.includes("144")) {
        alert("🤨 The Mayor needs you to be more professional. Check your answer!");
      } else {
        subPageStatus[8] = true;
        document.getElementById("boxA").innerHTML = "✅";
        showPage(3);
      }
    }
    function checkAnswersAndGoBackPage9() {
      const ans50 = document.getElementById('answer50_page9').value.toLowerCase();
      const ans90 = document.getElementById('answer90_page9').value.toLowerCase();
      if(!ans50.includes("50") || !ans90.includes("90")) {
        alert("🤨 The Mayor needs you to be more professional. Check your answer!");
      } else {
        subPageStatus[9] = true;
        document.getElementById("boxD").innerHTML = "✅";
        showPage(3);
      }
    }
    function checkAnswersAndGoBackPage10() {
      const ans114 = document.getElementById('answer114_page10').value.toLowerCase();
      const ansSqu = document.getElementById('answerSqu_page10').value.toLowerCase();
      const ans156 = document.getElementById('answer156_page10').value.toLowerCase();
      if(!ans114.includes("114") || !ansSqu.includes("squ") || !ans156.includes("156")) {
        alert("🤨 The Mayor needs you to be more professional. Check your answer!");
      } else {
        subPageStatus[10] = true;
        document.getElementById("boxF").innerHTML = "✅";
        showPage(3);
      }
    }
    function checkAnswersAndGoBackPage11() {
      const ansSqu = document.getElementById('answerSqu_page11').value.toLowerCase();
      const ans108 = document.getElementById('answer108_page11').value.toLowerCase();
      if(!ansSqu.includes("squ") || !ans108.includes("108")) {
        alert("🤨 The Mayor needs you to be more professional. Check your answer!");
      } else {
        subPageStatus[11] = true;
        document.getElementById("boxB").innerHTML = "✅";
        showPage(3);
      }
    }
    
    function checkPasswordPage22() {
      let ans = document.getElementById('answer5348_page22').value;
      if (ans === "5348") {
        document.getElementById('answer5348_page22').value = "";
        localStorage.setItem('answer5348_page22', "");
        window.open("https://daryeaye.github.io/geotopia/maike.pdf", "_blank");
        showPage(23);
      } else {
        alert("Did you finish the roof building?");
      }
    }
    
    function confirmName() {
      const name = document.getElementById("username").value.trim();
      if(name !== "") {
        localStorage.setItem("username", name);
        document.getElementById("username").disabled = true;
        alert("Name confirmed as: " + name);
      } else {
        alert("Please enter a name.");
      }
    }
    
    document.addEventListener("DOMContentLoaded", function() {
      setupPersistence();
      showPage(currentPage);
    });
  </script>
  
  <!-- Side Widget HTML -->
  <div id="side-widget">
    <p class="title">Need translation?</p>
    <button id="select-text">Select Text</button>
    <p>
      <a href="https://translate.google.com/?sl=en&tl=es&op=images" target="_blank">
        Click me and paste from clipboard
      </a>
    </p>
  </div>
  <!-- Side Widget Script -->
  <script>
    document.getElementById('select-text').addEventListener('click', function() {
      // Create overlay for user selection
      const overlay = document.createElement('div');
      overlay.id = 'selection-overlay';
      document.body.appendChild(overlay);
      
      let startX, startY, selectionBox;
      
      overlay.addEventListener('mousedown', function(e) {
        startX = e.clientX;
        startY = e.clientY;
        
        selectionBox = document.createElement('div');
        selectionBox.id = 'selection-box';
        selectionBox.style.left = startX + 'px';
        selectionBox.style.top = startY + 'px';
        selectionBox.style.width = '0px';
        selectionBox.style.height = '0px';
        overlay.appendChild(selectionBox);
        
        function mouseMoveHandler(e) {
          const currentX = e.clientX;
          const currentY = e.clientY;
          const rectLeft = Math.min(startX, currentX);
          const rectTop = Math.min(startY, currentY);
          const rectWidth = Math.abs(currentX - startX);
          const rectHeight = Math.abs(currentY - startY);
          selectionBox.style.left = rectLeft + 'px';
          selectionBox.style.top = rectTop + 'px';
          selectionBox.style.width = rectWidth + 'px';
          selectionBox.style.height = rectHeight + 'px';
        }
        
        function mouseUpHandler(e) {
          overlay.removeEventListener('mousemove', mouseMoveHandler);
          overlay.removeEventListener('mouseup', mouseUpHandler);
          
          const boxRect = selectionBox.getBoundingClientRect();
          document.body.removeChild(overlay);
          
          // Target the main app container to capture
          const target = document.getElementById('app-container');
          const targetRect = target.getBoundingClientRect();
          
          html2canvas(target, { useCORS: true, allowTaint: false }).then(canvas => {
            const scaleFactor = canvas.width / targetRect.width;
            const sx = (boxRect.left - targetRect.left) * scaleFactor;
            const sy = (boxRect.top - targetRect.top) * scaleFactor;
            const sWidth = boxRect.width * scaleFactor;
            const sHeight = boxRect.height * scaleFactor;
            
            const croppedCanvas = document.createElement('canvas');
            croppedCanvas.width = sWidth;
            croppedCanvas.height = sHeight;
            const ctx = croppedCanvas.getContext('2d');
            ctx.drawImage(canvas, sx, sy, sWidth, sHeight, 0, 0, sWidth, sHeight);
            
            croppedCanvas.toBlob(blob => {
              if (blob) {
                const item = new ClipboardItem({ 'image/png': blob });
                navigator.clipboard.write([item]).then(() => {
                  alert('Screenshot copied to clipboard.');
                }).catch(err => {
                  console.error('Failed to copy screenshot to clipboard', err);
                  alert('Failed to copy screenshot to clipboard.');
                });
              }
            });
          });
        }
        
        overlay.addEventListener('mousemove', mouseMoveHandler);
        overlay.addEventListener('mouseup', mouseUpHandler);
      });
    });
  </script>
</body>
</html>
